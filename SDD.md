# Docker Bastion SSH è¦æ ¼æ–‡æª” (SDD)
**ç‰ˆæœ¬ï¼š1.0.0**
**æœ€å¾Œæ›´æ–°ï¼š2026-01-09**

---

## ğŸ“‹ ç›®éŒ„

1. [ç”¢å“æ¦‚è¿°](#ç”¢å“æ¦‚è¿°)
2. [åŠŸèƒ½éœ€æ±‚](#åŠŸèƒ½éœ€æ±‚)
3. [éåŠŸèƒ½éœ€æ±‚](#éåŠŸèƒ½éœ€æ±‚)
4. [ç³»çµ±æ¶æ§‹](#ç³»çµ±æ¶æ§‹)
5. [ä½¿ç”¨å ´æ™¯](#ä½¿ç”¨å ´æ™¯)
6. [æŠ€è¡“å¯¦ç¾](#æŠ€è¡“å¯¦ç¾)
7. [API/æ¥å£è¨­è¨ˆ](#apiæ¥å£è¨­è¨ˆ)
8. [éƒ¨ç½²æ¶æ§‹](#éƒ¨ç½²æ¶æ§‹)
9. [å®‰å…¨æ€§è¨­è¨ˆ](#å®‰å…¨æ€§è¨­è¨ˆ)
10. [æ¸¬è©¦ç­–ç•¥](#æ¸¬è©¦ç­–ç•¥)
11. [æœªä¾†æ“´å±•è¨ˆç•«](#æœªä¾†æ“´å±•è¨ˆç•«)

---

## ç”¢å“æ¦‚è¿°

### 1.1 åç¨±èˆ‡ç°¡è¿°

**ç”¢å“åç¨±ï¼š** Docker Bastion SSH Server
**ç°¡è¿°ï¼š** ä¸€å€‹è¼•é‡ç´šã€å®‰å…¨çš„ SSH è·³æ¿æ©Ÿ (Bastion Host) Docker é¡åƒ

### 1.2 æ ¸å¿ƒåƒ¹å€¼ä¸»å¼µ

| ç‰¹æ€§ | æè¿° |
|------|------|
| **å®‰å…¨æ€§** | å¯†é‘°èªè­‰ + PermitOpen é™åˆ¶ï¼Œç¦ç”¨å¯†ç¢¼ç™»å…¥ |
| **è¼•é‡ç´š** | åŸºæ–¼ Alpine Linuxï¼Œé¡åƒå¤§å° ~20MB |
| **æ˜“ç”¨æ€§** | é–‹ç®±å³ç”¨ï¼Œæ”¯æ´å¤šç¨® SSH å·¥å…·æ•´åˆ |
| **éˆæ´»æ€§** | æ”¯æ´è‡ªè¨‚ PermitOpen è¦å‰‡å’Œè½‰ç™¼é™åˆ¶ |
| **å¯é æ€§** | å¥åº·æª¢æŸ¥ã€è‡ªå‹•é‡å•Ÿã€æ—¥èªŒæŒä¹…åŒ– |

### 1.3 ç›®æ¨™ç”¨æˆ¶

- **DevOps å·¥ç¨‹å¸«** - éœ€è¦å®‰å…¨ SSH Gateway çš„åœ˜éšŠ
- **ç³»çµ±ç®¡ç†å“¡** - ç®¡ç†å¤šå€‹æœå‹™å™¨å’Œç¶²è·¯è¨­å‚™
- **åŸºç¤è¨­æ–½å·¥ç¨‹å¸«** - åœ¨é›²ç«¯ç’°å¢ƒä¸­éœ€è¦è¨ªå•å…¥å£çš„çµ„ç¹”
- **Ansible ç”¨æˆ¶** - éœ€è¦é€šéè·³æ¿æ©Ÿè¨ªå•å†…ç½‘ä¸»æ©Ÿ

### 1.4 ä¸»è¦æ‡‰ç”¨å ´æ™¯

1. Ansible Playbook åŸ·è¡Œï¼ˆé€šéè·³æ¿æ©Ÿè¨ªå•å†…ç½‘ä¸»æ©Ÿï¼‰
2. SSH ProxyCommand è½‰ç™¼
3. SCP æ–‡ä»¶å‚³è¼¸
4. å¤šç’°å¢ƒ SSH Gateway
5. ç¶²è·¯éš”é›¢ç’°å¢ƒçš„è¨ªå•å…¥å£

---

## åŠŸèƒ½éœ€æ±‚

### 2.1 èªè­‰åŠŸèƒ½

**éœ€æ±‚ F1ï¼šSSH å¯†é‘°èªè­‰**
- ç³»çµ±å¿…é ˆæ”¯æ´ SSH å…¬é‘°èªè­‰
- ç¦ç”¨å¯†ç¢¼èªè­‰å’Œç©ºå¯†ç¢¼ç™»å…¥
- æ”¯æ´ ED25519ã€RSAã€ECDSA ç­‰æ¨™æº–å¯†é‘°é¡å‹
- å…¬é‘°å­˜å„²åœ¨ `/root/.ssh/authorized_keys`

**éœ€æ±‚ F2ï¼šç”¨æˆ¶è¨ªå•æ§åˆ¶**
- åƒ…å…è¨± root ç”¨æˆ¶ç™»å…¥
- ç¦æ­¢å…¶ä»–ç”¨æˆ¶è¨ªå•
- é…ç½®é …ï¼š`AllowUsers root`

### 2.2 é€£æ¥è½‰ç™¼åŠŸèƒ½

**éœ€æ±‚ F3ï¼šTCP è½‰ç™¼æ”¯æ´**
- æ”¯æ´ SSH `-W` åƒæ•¸ï¼ˆstdio è½‰ç™¼ï¼‰
- æ”¯æ´ ProxyCommand æ–¹å¼çš„é€£æ¥
- å•Ÿç”¨ TCP è½‰ç™¼ï¼š`AllowTcpForwarding yes`

**éœ€æ±‚ F4ï¼šè½‰ç™¼ç›®æ¨™é™åˆ¶ï¼ˆPermitOpenï¼‰**
- ä½¿ç”¨ PermitOpen é™åˆ¶è½‰ç™¼ç›®æ¨™
- é è¨­é™åˆ¶åˆ° `192.168.1.*:22`ï¼ˆå¯è‡ªè¨‚ï¼‰
- æ”¯æ´å¤šå€‹è½‰ç™¼ç›®æ¨™è¦å‰‡
- è¦å‰‡å¯é€šéé…ç½®æ–‡ä»¶ä¿®æ”¹

### 2.3 å®¹å™¨åŠŸèƒ½

**éœ€æ±‚ F5ï¼šDocker éƒ¨ç½²**
- æä¾› Dockerfileï¼ŒåŸºæ–¼ Alpine Linux 3.18
- æ”¯æ´ Docker Compose ç·¨æ’
- å¯ç›´æ¥é€šé `docker run` æˆ– `docker-compose` å•Ÿå‹•

**éœ€æ±‚ F6ï¼šå¥åº·æª¢æŸ¥**
- å®šæœŸæª¢æŸ¥ SSH æœå‹™å¥åº·ç‹€æ…‹
- ä½¿ç”¨ `sshd -t` é©—è­‰é…ç½®æœ‰æ•ˆæ€§
- æª¢æŸ¥å‘¨æœŸï¼š30 ç§’
- å¤±æ•—é‡è©¦æ¬¡æ•¸ï¼š3 æ¬¡

**éœ€æ±‚ F7ï¼šæ—¥èªŒç®¡ç†**
- æ‰€æœ‰ SSH èªè­‰æ—¥èªŒè¨˜éŒ„åˆ° `/var/log`
- æ”¯æ´æ—¥èªŒæŒä¹…åŒ–ï¼ˆé€šé Volume æ›è¼‰ï¼‰
- æ—¥èªŒç´šåˆ¥ï¼šVERBOSE
- åŒ…å«èªè­‰æˆåŠŸå’Œå¤±æ•—çš„è©³ç´°è¨˜éŒ„

### 2.4 ç®¡ç†å·¥å…·

**éœ€æ±‚ F8ï¼šMakefile å‘½ä»¤**
æä¾›å¿«é€Ÿå‘½ä»¤é€²è¡Œæ—¥å¸¸æ“ä½œï¼š
- `make build` - æ§‹å»º Docker é¡åƒ
- `make up` - å•Ÿå‹•å®¹å™¨
- `make down` - åœæ­¢å®¹å™¨
- `make logs` - æŸ¥çœ‹æ—¥èªŒ
- `make test-connect` - æ¸¬è©¦ SSH é€£æ¥
- `make test-config` - é©—è­‰ SSH é…ç½®
- `make shell` - é€²å…¥å®¹å™¨ shell
- `make clean` - æ¸…ç†è³‡æº
- `make verify` - é©—è­‰ç’°å¢ƒ

---

## éåŠŸèƒ½éœ€æ±‚

### 3.1 æ€§èƒ½éœ€æ±‚

| æŒ‡æ¨™ | ç›®æ¨™å€¼ |
|------|-------|
| SSH é€£æ¥å»ºç«‹æ™‚é–“ | < 2 ç§’ |
| èªè­‰å®Œæˆæ™‚é–“ | < 1 ç§’ |
| æ•¸æ“šè½‰ç™¼å»¶é² | < 100ms |
| å®¹å™¨å•Ÿå‹•æ™‚é–“ | < 5 ç§’ |
| é¡åƒå¤§å° | < 30MB |

### 3.2 å¯é æ€§éœ€æ±‚

- **å¯ç”¨æ€§ï¼š** 99.9% çš„é€£æ¥æˆåŠŸç‡ï¼ˆæ­£å¸¸é…ç½®ä¸‹ï¼‰
- **æ•…éšœæ¢å¾©ï¼š** è‡ªå‹•é‡å•Ÿå¤±æ•—çš„å®¹å™¨ï¼ˆ`restart: unless-stopped`ï¼‰
- **æ—¥èªŒä¿ç•™ï¼š** è‡³å°‘ä¿å­˜ 7 å¤©çš„èªè­‰æ—¥èªŒ
- **å¥åº·æª¢æŸ¥ï¼š** 30 ç§’æª¢æŸ¥ä¸€æ¬¡æœå‹™å¥åº·

### 3.3 å®‰å…¨éœ€æ±‚

**å¯†ç¢¼ç­–ç•¥ï¼š**
- ç¦ç”¨å¯†ç¢¼èªè­‰
- ç¦ç”¨ç©ºå¯†ç¢¼ç™»å…¥
- ç¦ç”¨ Root å¯†ç¢¼ç™»å…¥

**åŠ å¯†ç®—æ³•ï¼š**
- æ”¯æ´ç¾ä»£åŠ å¯†ç®—æ³•ï¼šAES-256-CTR, ChaCha20
- HMACï¼šSHA-2-256, SHA-2-512
- é‡‘é‘°äº¤æ›ï¼šCurve25519, DH-group-exchange

**è¨ªå•æ§åˆ¶ï¼š**
- é™åˆ¶ TCP è½‰ç™¼ç›®æ¨™ï¼ˆPermitOpenï¼‰
- ç¦ç”¨ X11 è½‰ç™¼
- ç¦ç”¨ Agent è½‰ç™¼
- ç¦ç”¨éš§é“æ¨¡å¼

**èªè­‰é™åˆ¶ï¼š**
- æœ€å¤§èªè­‰å˜—è©¦æ¬¡æ•¸ï¼š3 æ¬¡
- æœ€å¤§æœƒè©±æ•¸ï¼š5 å€‹
- é€£æ¥è¶…æ™‚ï¼š60 ç§’
- å®¢æˆ¶ç«¯ä¿æ´»é–“éš”ï¼š300 ç§’

### 3.4 å¯ç¶­è­·æ€§éœ€æ±‚

- **æ–‡æª”å®Œæ•´æ€§ï¼š** æä¾›ä½¿ç”¨ã€é…ç½®ã€æ•…éšœæ’é™¤æ–‡æª”
- **é…ç½®éˆæ´»æ€§ï¼š** æ”¯æ´é€šé Volume æ›è¼‰è‡ªè¨‚é…ç½®
- **æ—¥èªŒå¯è®€æ€§ï¼š** è©³ç´°çš„æ—¥èªŒè¨˜éŒ„ä¾¿æ–¼è¨ºæ–·
- **æ¨™æº–åŒ–ï¼š** éµå¾ª OpenSSH æ¨™æº–é…ç½®è¦ç¯„

### 3.5 å…¼å®¹æ€§éœ€æ±‚

- **æ“ä½œç³»çµ±ï¼š** Linuxï¼ˆæ”¯æ´ Docker çš„ä»»ä½•ç³»çµ±ï¼‰
- **Docker ç‰ˆæœ¬ï¼š** 17.05+ï¼ˆæ”¯æŒå¤šéšæ®µæ§‹å»ºï¼‰
- **Docker Compose ç‰ˆæœ¬ï¼š** 1.14+ï¼ˆæ”¯æŒ version 3.8ï¼‰
- **SSH å®¢æˆ¶ç«¯ï¼š** ä»»ä½•æ¨™æº– SSH å®¢æˆ¶ç«¯ï¼ˆOpenSSH 7.0+ï¼‰

---

## ç³»çµ±æ¶æ§‹

### 4.1 æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸»æ©Ÿç’°å¢ƒ                          â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Docker å®¹å™¨ (ansible-bastion)              â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Alpine Linux 3.18                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - OpenSSH 9.3_p2-r1                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Bash                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - Doas                                â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  SSH æœå‹™é…ç½®                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - sshd_config (ç«¯å£ 22)                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - authorized_keys                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - ä¸»æ©Ÿå¯†é‘°                              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  æ—¥èªŒç³»çµ±                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - /var/log/auth.log (SSH èªè­‰æ—¥èªŒ)    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  - /var/log/syslog                      â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                               â”‚  â”‚
â”‚  â”‚  é€²ç¨‹ï¼šsshd (PID 1)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†‘ ç«¯å£æ˜ å°„: 2222 â†” 22                      â”‚
â”‚                                                      â”‚
â”‚  Volume æ›è¼‰ï¼š                                       â”‚
â”‚  - bastion_logs â†’ /var/log                         â”‚
â”‚  - (å¯é¸) ./config/ â†’ /etc/ssh/ & /root/.ssh/      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤–éƒ¨è¨ªå•æµï¼š
SSH å®¢æˆ¶ç«¯ (localhost:2222)
         â†“
      sshd (127.0.0.1:22)
         â†“
   é©—è­‰ authorized_keys
         â†“
PermitOpen é™åˆ¶æª¢æŸ¥
         â†“
   å…è¨±/æ‹’çµ•è½‰ç™¼
         â†“
   ProxyCommand åŸ·è¡Œ
         â†“
ç›®æ¨™ä¸»æ©Ÿ (192.168.1.x:22 ç­‰)
```

### 4.2 çµ„ä»¶èªªæ˜

| çµ„ä»¶ | ç‰ˆæœ¬ | ä½œç”¨ |
|------|------|------|
| **Alpine Linux** | 3.18 | è¼•é‡ç´šåŸºç¤é¡åƒ |
| **OpenSSH** | 9.3_p2-r1 | SSH æœå‹™å™¨å¯¦ç¾ |
| **OpenSSH Client** | 9.3_p2-r1 | SSH å®¢æˆ¶ç«¯å·¥å…· |
| **Bash** | latest | Shell ç’°å¢ƒ |
| **Doas** | latest | æ¬Šé™æå‡å·¥å…·ï¼ˆå¯é¸ï¼‰ |

### 4.3 æ•¸æ“šæµ

```
èªè­‰æµç¨‹ï¼š
1. SSH å®¢æˆ¶ç«¯ â†’ sshd (TCP 2222/22)
2. sshd è®€å– authorized_keys
3. é©—è­‰å…¬é‘°ç°½å
4. æ—¥èªŒè¨˜éŒ„èªè­‰çµæœ
5. èªè¨¼æˆåŠŸ â†’ å»ºç«‹ SSH session

è½‰ç™¼æµç¨‹ï¼š
1. SSH å®¢æˆ¶ç«¯ç™¼èµ· ProxyCommand é€£æ¥
2. sshd æª¢æŸ¥ PermitOpen é™åˆ¶
3. æª¢æŸ¥ç›®æ¨™åœ°å€æ˜¯å¦åœ¨å…è¨±åˆ—è¡¨
4. å…è¨± â†’ å»ºç«‹è½‰ç™¼é€šé“
5. æ‹’çµ• â†’ é—œé–‰é€£æ¥ï¼Œè¨˜éŒ„æ—¥èªŒ
```

---

## ä½¿ç”¨å ´æ™¯

### 5.1 Ansible è·³æ¿æ©Ÿ

**å ´æ™¯æè¿°ï¼š** ä½¿ç”¨ Ansible ç®¡ç†ä½æ–¼ç§æœ‰ç¶²è·¯ä¸­çš„ä¸»æ©Ÿ

**å·¥ä½œæµç¨‹ï¼š**
```bash
# Ansible ä¸»æ©Ÿé…ç½®
ansible_ssh_common_args: >
  -o ProxyCommand="ssh -W %h:%p -i ~/.ssh/bastion_key -p 2222 root@localhost"

# åŸ·è¡Œ Playbook
ansible-playbook -i inventory.yml playbook.yml
```

**å„ªé»ï¼š**
- ç„¡éœ€é–‹æ”¾ç›®æ¨™ä¸»æ©Ÿçš„ SSH ç«¯å£åˆ°äº’è¯ç¶²
- æ‰€æœ‰é€£æ¥é€šéè·³æ¿æ©Ÿï¼Œä¾¿æ–¼å¯©è¨ˆå’Œç›£æ§
- æ”¯æ´è¤‡é›œçš„å¤šå±¤ç¶²è·¯æ‹“æ’²

### 5.2 SSH ProxyCommand è½‰ç™¼

**å ´æ™¯æè¿°ï¼š** ç›´æ¥é€šéè·³æ¿æ©Ÿ SSH åˆ°å†…ç½‘ä¸»æ©Ÿ

**å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
ssh -o ProxyCommand='ssh -W %h:%p -i ~/.ssh/bastion_key -p 2222 root@localhost' \
    -i ~/.ssh/target_key user@192.168.1.10
```

**æ‡‰ç”¨å ´æ™¯ï¼š**
- ç›´æ¥ SSH è¨ªå•å…§ç¶²è¨­å‚™
- é‹ç¶­äººå“¡è‡¨æ™‚è¨ªå•
- æ•…éšœè¨ºæ–·å’Œèª¿è©¦

### 5.3 SCP æ–‡ä»¶å‚³è¼¸

**å ´æ™¯æè¿°ï¼š** é€šéè·³æ¿æ©Ÿå‚³è¼¸æ–‡ä»¶åˆ°/å¾å†…ç½‘ä¸»æ©Ÿ

**å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
# ä¸Šå‚³æ–‡ä»¶
scp -o ProxyCommand='ssh -W %h:%p -i ~/.ssh/bastion_key -p 2222 root@localhost' \
    local_file.txt user@192.168.1.10:/remote/path/

# ä¸‹è¼‰æ–‡ä»¶
scp -o ProxyCommand='ssh -W %h:%p -i ~/.ssh/bastion_key -p 2222 root@localhost' \
    user@192.168.1.10:/remote/file.txt local_path/
```

### 5.4 å¤šç’°å¢ƒ SSH Gateway

**å ´æ™¯æè¿°ï¼š** ä½œç‚ºçµ±ä¸€çš„ SSH è¨ªå•å…¥å£ï¼Œæ”¯æ´å¤šå€‹å†…ç½‘ç’°å¢ƒ

**éƒ¨ç½²æ¶æ§‹ï¼š**
```
äº’è¯ç¶² â†’ Bastion-1 â†’ é–‹ç™¼ç’°å¢ƒ (192.168.1.0/24)
      â†’ Bastion-2 â†’ æ¸¬è©¦ç’°å¢ƒ (10.0.1.0/24)
      â†’ Bastion-3 â†’ ç”Ÿç”¢ç’°å¢ƒ (172.16.1.0/24)
```

**å„ªé»ï¼š**
- çµ±ä¸€çš„è¨ªå•æ§åˆ¶ç­–ç•¥
- æ¯å€‹ç’°å¢ƒç¨ç«‹çš„è·³æ¿æ©Ÿå’Œæ—¥èªŒ
- æ˜“æ–¼æ“´å±•æ–°ç’°å¢ƒ

---

## æŠ€è¡“å¯¦ç¾

### 6.1 Dockerfile å¯¦ç¾è©³è§£

```dockerfile
FROM alpine:3.18                                    # è¼•é‡ç´šåŸºç¤é¡åƒ

LABEL maintainer="Ansible Network Lab"            # å…ƒæ•¸æ“š
LABEL description="Bastion SSH Server..."

RUN apk update && \
    apk add --no-cache \
        openssh=9.3_p2-r1 \                       # SSH ä¼ºæœå™¨
        openssh-client=9.3_p2-r1 \                # SSH å®¢æˆ¶ç«¯
        bash \                                     # Shell
        doas                                       # æ¬Šé™å·¥å…·
    && rm -rf /var/cache/apk/*                    # æ¸…ç†å¿«å–ï¼Œæ¸›å°é¡åƒ

RUN mkdir -p /run/sshd && chmod 755 /run/sshd    # SSH é‹è¡Œç›®éŒ„

RUN mkdir -p /root/.ssh && chmod 700 /root/.ssh  # SSH å¯†é‘°ç›®éŒ„

COPY config/sshd_config /etc/ssh/sshd_config     # è¤‡è£½é…ç½®
RUN chmod 600 /etc/ssh/sshd_config

COPY config/authorized_keys /root/.ssh/           # è¤‡è£½å…¬é‘°
RUN chmod 600 /root/.ssh/authorized_keys

COPY scripts/entrypoint.sh /entrypoint.sh         # è¤‡è£½å•Ÿå‹•è…³æœ¬
RUN chmod +x /entrypoint.sh

RUN ssh-keygen -A                                  # ç”Ÿæˆä¸»æ©Ÿå¯†é‘°

HEALTHCHECK --interval=30s --timeout=10s ...      # å¥åº·æª¢æŸ¥
    CMD sshd -t && echo "SSH service is healthy"

EXPOSE 22                                          # æš´éœ² SSH ç«¯å£

ENTRYPOINT ["/entrypoint.sh"]                     # å®¹å™¨å•Ÿå‹•å‘½ä»¤
```

**æ§‹å»ºç‰¹é»ï¼š**
- ä½¿ç”¨å¤šè¡Œ RUN æŒ‡ä»¤æ¸›å°‘å±¤æ•¸
- æ¸…ç† apk å¿«å–æ¸›å°é¡åƒå¤§å°
- é ç”Ÿæˆä¸»æ©Ÿå¯†é‘°æé«˜å•Ÿå‹•é€Ÿåº¦
- å¥åº·æª¢æŸ¥ç¢ºä¿æœå‹™å¯ç”¨

### 6.2 SSH é…ç½®èªªæ˜

**é—œéµé…ç½®é …ï¼š**

| é…ç½®é … | å€¼ | èªªæ˜ |
|--------|-----|------|
| `Port` | 22 | SSH ç›£è½ç«¯å£ |
| `PubkeyAuthentication` | yes | å•Ÿç”¨å¯†é‘°èªè­‰ |
| `PasswordAuthentication` | no | ç¦ç”¨å¯†ç¢¼èªè­‰ |
| `PermitRootLogin` | prohibit-password | Root éœ€è¦å¯†é‘° |
| `AllowTcpForwarding` | yes | å•Ÿç”¨ TCP è½‰ç™¼ |
| `PermitOpen` | 192.168.1.*:22 | é™åˆ¶è½‰ç™¼ç›®æ¨™ |
| `AllowAgentForwarding` | no | ç¦ç”¨ Agent è½‰ç™¼ |
| `X11Forwarding` | no | ç¦ç”¨ X11 è½‰ç™¼ |
| `MaxAuthTries` | 3 | æœ€å¤§èªè­‰å˜—è©¦ |
| `MaxSessions` | 5 | æœ€å¤§æœƒè©±æ•¸ |
| `ClientAliveInterval` | 300 | ä¿æ´»é–“éš”ï¼ˆç§’ï¼‰ |

### 6.3 Docker Compose é…ç½®èªªæ˜

```yaml
version: '3.8'                                    # Compose ç‰ˆæœ¬

services:
  bastion:
    build:                                        # æ§‹å»ºé…ç½®
      context: .
      dockerfile: Dockerfile

    container_name: ansible-bastion              # å›ºå®šå®¹å™¨åç¨±

    ports:
      - "2222:22"                                # ç«¯å£æ˜ å°„ï¼šä¸»æ©Ÿ:å®¹å™¨

    environment:
      TZ: UTC                                    # æ™‚å€è¨­ç½®

    volumes:                                      # æ•¸æ“šå·
      - bastion_logs:/var/log                    # æ—¥èªŒæŒä¹…åŒ–

    healthcheck:                                  # å¥åº·æª¢æŸ¥é…ç½®
      test: ["CMD", "sshd", "-t"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 5s

    networks:
      - ansible_network                         # è‡ªè¨‚ç¶²è·¯

    restart: unless-stopped                      # è‡ªå‹•é‡å•Ÿç­–ç•¥

    cap_drop:                                     # å®‰å…¨ï¼šåˆ é™¤æ‰€æœ‰ç‰¹æ¬Š
      - ALL
    cap_add:                                      # åªæ·»åŠ å¿…éœ€çš„ç‰¹æ¬Š
      - NET_BIND_SERVICE                        # ç¶å®šä½ç«¯å£
      - CHOWN
      - SETUID
      - SETGID
      - DAC_OVERRIDE

networks:
  ansible_network:                              # è‡ªè¨‚æ©‹æ¥ç¶²çµ¡
    driver: bridge

volumes:
  bastion_logs:                                  # æ—¥èªŒå·
    driver: local
```

---

## API/æ¥å£è¨­è¨ˆ

### 7.1 SSH å”è­°æ¥å£

**å”è­°ç‰ˆæœ¬ï¼š** SSH-2.0

**æ”¯æ´çš„èªè­‰æ–¹æ³•ï¼š**
```
publickey    # å…¬é‘°èªè­‰ï¼ˆå”¯ä¸€æ”¯æ´ï¼‰
```

**æ”¯æ´çš„å¯†é‘°é¡å‹ï¼š**
```
ssh-rsa           # RSA
ecdsa-sha2-nistp256
ecdsa-sha2-nistp384
ecdsa-sha2-nistp521
ssh-ed25519       # Ed25519ï¼ˆæ¨è–¦ï¼‰
```

### 7.2 å‘½ä»¤è¡Œæ¥å£

**SSH é€£æ¥æ¥å£ï¼š**
```bash
ssh -i <private_key> -p 2222 root@<bastion_host>
```

**åƒæ•¸èªªæ˜ï¼š**
- `-i <private_key>`: ç§é‘°æ–‡ä»¶è·¯å¾‘
- `-p 2222`: SSH ç«¯å£ï¼ˆdocker-compose ä¸­æ˜ å°„çš„ç«¯å£ï¼‰
- `root`: å”¯ä¸€å…è¨±çš„ç”¨æˆ¶
- `<bastion_host>`: Bastion ä¸»æ©Ÿåœ°å€ï¼ˆlocalhost æˆ– IPï¼‰

**ProxyCommand æ¥å£ï¼š**
```bash
ssh -o ProxyCommand='ssh -W %h:%p -i ~/.ssh/bastion_key -p 2222 root@localhost' \
    -i ~/.ssh/target_key user@<target_host>
```

**åƒæ•¸èªªæ˜ï¼š**
- `-W %h:%p`: stdio è½‰ç™¼åˆ°ç›®æ¨™ host:port
- `root@localhost`: Bastion é€£æ¥ä¿¡æ¯

### 7.3 ç’°å¢ƒè®Šé‡æ¥å£

| è®Šé‡ | é è¨­å€¼ | èªªæ˜ |
|------|--------|------|
| `TZ` | UTC | æ™‚å€è¨­ç½®ï¼ˆå¯é¸ï¼‰ |

### 7.4 Volume æ¥å£

| è·¯å¾‘ | ç”¨é€” | æ¬Šé™ | å¿…éœ€ |
|------|------|------|------|
| `/var/log` | æ—¥èªŒå­˜å„² | rw | å¦ |
| `/root/.ssh/authorized_keys` | SSH å…¬é‘° | ro | æ˜¯ |
| `/etc/ssh/sshd_config` | SSH é…ç½® | ro | å¦ |

---

## éƒ¨ç½²æ¶æ§‹

### 8.1 æœ¬åœ°é–‹ç™¼éƒ¨ç½²

```bash
# 1. å…‹éš†æˆ–é€²å…¥å°ˆæ¡ˆ
cd docker-bastion-ssh

# 2. æº–å‚™ SSH å…¬é‘°
ssh-keygen -t ed25519 -f config/id_ed25519 -N ""
cat config/id_ed25519.pub > config/authorized_keys

# 3. ä½¿ç”¨ docker-compose å•Ÿå‹•
docker-compose up -d

# 4. æ¸¬è©¦é€£æ¥
ssh -i config/id_ed25519 -p 2222 root@localhost
```

### 8.2 ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

**é…ç½®å»ºè­°ï¼š**

```yaml
services:
  bastion:
    # ... åŸºç¤é…ç½® ...

    # è³‡æºé™åˆ¶
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 256M
        reservations:
          cpus: '0.25'
          memory: 128M

    # æ—¥èªŒé©…å‹•é…ç½®
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

    # Volume æ›è¼‰ç”Ÿç”¢å¯†é‘°
    volumes:
      - ./config/authorized_keys:/root/.ssh/authorized_keys:ro
      - ./config/sshd_config:/etc/ssh/sshd_config:ro
      - bastion_logs:/var/log
```

### 8.3 Kubernetes éƒ¨ç½²

åŸºç¤ Deployment é…ç½®ï¼š

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: bastion-ssh
  namespace: default

spec:
  replicas: 2
  selector:
    matchLabels:
      app: bastion-ssh

  template:
    metadata:
      labels:
        app: bastion-ssh

    spec:
      containers:
      - name: bastion
        image: ansible-bastion:latest
        imagePullPolicy: IfNotPresent

        ports:
        - containerPort: 22
          name: ssh

        volumeMounts:
        - name: authorized-keys
          mountPath: /root/.ssh/authorized_keys
          subPath: authorized_keys
          readOnly: true

        - name: sshd-config
          mountPath: /etc/ssh/sshd_config
          subPath: sshd_config
          readOnly: true

        - name: logs
          mountPath: /var/log

        livenessProbe:
          exec:
            command: ["sshd", "-t"]
          initialDelaySeconds: 5
          periodSeconds: 30

        readinessProbe:
          exec:
            command: ["sshd", "-t"]
          initialDelaySeconds: 5
          periodSeconds: 10

        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 256Mi

        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: false
          runAsNonRoot: false
          runAsUser: 0
          capabilities:
            drop:
              - ALL
            add:
              - NET_BIND_SERVICE
              - CHOWN
              - SETUID
              - SETGID

      volumes:
      - name: authorized-keys
        configMap:
          name: bastion-authorized-keys

      - name: sshd-config
        configMap:
          name: bastion-sshd-config

      - name: logs
        emptyDir: {}

---
apiVersion: v1
kind: Service
metadata:
  name: bastion-ssh
  namespace: default

spec:
  type: LoadBalancer
  selector:
    app: bastion-ssh

  ports:
  - port: 2222
    targetPort: 22
    protocol: TCP
```

---

## å®‰å…¨æ€§è¨­è¨ˆ

### 9.1 èªè­‰å®‰å…¨

**å¯¦ç¾æ–¹å¼ï¼š**
- âœ… åƒ…æ”¯æ´å…¬é‘°èªè­‰
- âœ… ç¦ç”¨å¯†ç¢¼èªè­‰
- âœ… ç¦ç”¨ç©ºå¯†ç¢¼ç™»å…¥
- âœ… æ”¯æ´ç¾ä»£å¯†é‘°é¡å‹ï¼ˆEd25519ã€ECDSAï¼‰

**å®‰å…¨åƒæ•¸ï¼š**
```
MaxAuthTries 3              # é™åˆ¶èªè­‰å˜—è©¦æ¬¡æ•¸
LoginGraceTime 60           # é€£æ¥è¶…æ™‚
ClientAliveInterval 300     # ä¿æ´»é–“éš”
```

### 9.2 åŠ å¯†å®‰å…¨

**å¯†ç¢¼å¥—ä»¶é…ç½®ï¼š**

**å°ç¨±åŠ å¯†ï¼š**
```
Ciphers aes128-ctr,aes192-ctr,aes256-ctr,
        aes128-gcm@openssh.com,aes256-gcm@openssh.com
```

**æ¶ˆæ¯èªè­‰ç¢¼ (MAC)ï¼š**
```
MACs hmac-sha2-256,hmac-sha2-512,
     umac-128@openssh.com,umac-256@openssh.com
```

**é‡‘é‘°äº¤æ›ï¼š**
```
KexAlgorithms curve25519-sha256,
              curve25519-sha256@libssh.org,
              diffie-hellman-group-exchange-sha256
```

### 9.3 è¨ªå•æ§åˆ¶

**ç”¨æˆ¶é™åˆ¶ï¼š**
```
AllowUsers root                    # åƒ…å…è¨± root
```

**è½‰ç™¼é™åˆ¶ï¼š**
```
AllowTcpForwarding yes             # å•Ÿç”¨ TCP è½‰ç™¼
AllowAgentForwarding no            # ç¦ç”¨ Agent è½‰ç™¼
X11Forwarding no                   # ç¦ç”¨ X11
PermitTunnel no                    # ç¦ç”¨éš§é“
GatewayPorts no                    # ç¦æ­¢ç›£è½æ‰€æœ‰åœ°å€

PermitOpen 192.168.1.*:22          # PermitOpen é™åˆ¶
```

### 9.4 ä¸»æ©Ÿå¯†é‘°ç®¡ç†

**å¯¦ç¾æ–¹å¼ï¼š**
```dockerfile
RUN ssh-keygen -A                  # è‡ªå‹•ç”Ÿæˆæ‰€æœ‰é¡å‹çš„ä¸»æ©Ÿå¯†é‘°
```

**ç”Ÿæˆçš„å¯†é‘°ï¼š**
- `/etc/ssh/ssh_host_rsa_key` - RSA ä¸»æ©Ÿå¯†é‘°
- `/etc/ssh/ssh_host_ecdsa_key` - ECDSA ä¸»æ©Ÿå¯†é‘°
- `/etc/ssh/ssh_host_ed25519_key` - Ed25519 ä¸»æ©Ÿå¯†é‘°

**ç”Ÿç”¢ç’°ä¿å»ºè­°ï¼š**
- å®¹å™¨å•Ÿå‹•æ™‚æŒä¹…åŒ–ä¸»æ©Ÿå¯†é‘°
- å¤šå¯¦ä¾‹æ™‚å…±äº«å¯†é‘°ä»¥ä¿æŒèªè­‰ä¸€è‡´æ€§

### 9.5 æ—¥èªŒå®‰å…¨

**æ—¥èªŒé…ç½®ï¼š**
```
SyslogFacility AUTH               # ä½¿ç”¨ AUTH facility
LogLevel VERBOSE                  # è©³ç´°æ—¥èªŒç´šåˆ¥
```

**è¨˜éŒ„å…§å®¹ï¼š**
- æ‰€æœ‰èªè­‰å˜—è©¦ï¼ˆæˆåŠŸå’Œå¤±æ•—ï¼‰
- SSH é€£æ¥è©³æƒ…
- ç•°å¸¸ç™»å…¥æ´»å‹•

**æ—¥èªŒä¿ç•™ï¼š**
- å»ºè­°åœ¨å®¹å™¨å¤–æŒä¹…åŒ–æ—¥èªŒ
- å®šæœŸå¯©è¨ˆæ—¥èªŒå…§å®¹
- é›†æˆåˆ°ä¸­å¤®æ—¥èªŒç³»çµ±ï¼ˆELKã€Splunk ç­‰ï¼‰

### 9.6 å®¹å™¨å®‰å…¨

**æ¬Šé™åˆ†é›¢ï¼š**
```yaml
cap_drop:
  - ALL
cap_add:
  - NET_BIND_SERVICE
  - CHOWN
  - SETUID
  - SETGID
  - DAC_OVERRIDE
```

**å®‰å…¨å»ºè­°ï¼š**
- ä»¥ root é‹è¡Œï¼ˆSSH æœå‹™éœ€è¦ï¼‰
- ç¦ç”¨ä¸å¿…è¦çš„ Linux capabilities
- ä½¿ç”¨éš»è®€æ ¹æ–‡ä»¶ç³»çµ±ï¼ˆå¦‚å¯èƒ½ï¼‰
- å®šæœŸæƒæå®¹å™¨é¡åƒå®‰å…¨æ¼æ´

---

## æ¸¬è©¦ç­–ç•¥

### 10.1 å–®å…ƒæ¸¬è©¦

**é…ç½®é©—è­‰ï¼š**
```bash
# æ¸¬è©¦ sshd é…ç½®èªæ³•
sshd -t

# æ¸¬è©¦å‘½ä»¤
make test-config
```

**é©—è­‰é …ï¼š**
- [ ] sshd_config èªæ³•æ­£ç¢º
- [ ] æ‰€æœ‰å¿…éœ€çš„é…ç½®é …å­˜åœ¨
- [ ] PermitOpen è¦å‰‡æœ‰æ•ˆ

### 10.2 é›†æˆæ¸¬è©¦

**SSH é€£æ¥æ¸¬è©¦ï¼š**
```bash
# æ¸¬è©¦å…¬é‘°èªè­‰
ssh -i <private_key> -p 2222 root@localhost

# æ¸¬è©¦å‘½ä»¤åŸ·è¡Œ
ssh -i <private_key> -p 2222 root@localhost "echo test"

# æ¸¬è©¦é€£æ¥
make test-connect
```

**é©—è­‰é …ï¼š**
- [ ] SSH é€£æ¥æˆåŠŸ
- [ ] å…¬é‘°èªè­‰æ­£å¸¸å·¥ä½œ
- [ ] å‘½ä»¤åŸ·è¡ŒæˆåŠŸ
- [ ] é€£æ¥æ–·é–‹æ­£å¸¸

### 10.3 è½‰ç™¼åŠŸèƒ½æ¸¬è©¦

**TCP è½‰ç™¼æ¸¬è©¦ï¼š**
```bash
# æ¸¬è©¦ ProxyCommand è½‰ç™¼
ssh -o ProxyCommand='ssh -W %h:%p -i <key> -p 2222 root@localhost' \
    user@192.168.1.10

# æ¸¬è©¦ SCP è½‰ç™¼
scp -o ProxyCommand='ssh -W %h:%p -i <key> -p 2222 root@localhost' \
    file.txt user@192.168.1.10:/path/
```

**é©—è­‰é …ï¼š**
- [ ] ProxyCommand è½‰ç™¼æˆåŠŸ
- [ ] PermitOpen é™åˆ¶ç”Ÿæ•ˆ
- [ ] éå…è¨±ç›®æ¨™è¢«æ‹’çµ•

### 10.4 å®‰å…¨æ¸¬è©¦

**èªè­‰å®‰å…¨æ¸¬è©¦ï¼š**
```bash
# æ¸¬è©¦å¯†ç¢¼èªè­‰ï¼ˆæ‡‰å¤±æ•—ï¼‰
ssh -o PasswordAuthentication=yes -p 2222 root@localhost

# æ¸¬è©¦ç©ºå¯†ç¢¼ï¼ˆæ‡‰å¤±æ•—ï¼‰
ssh -p 2222 root@localhost
```

**é©—è­‰é …ï¼š**
- [ ] å¯†ç¢¼èªè­‰è¢«ç¦ç”¨
- [ ] ç©ºå¯†ç¢¼è¢«ç¦ç”¨
- [ ] åªå…è¨± root ç”¨æˆ¶

### 10.5 æ€§èƒ½æ¸¬è©¦

**é€£æ¥æ€§èƒ½ï¼š**
```bash
# æ¸¬è©¦é€£æ¥å»ºç«‹æ™‚é–“
time ssh -i <key> -p 2222 root@localhost exit

# æ¸¬è©¦èªè­‰æ™‚é–“
time ssh -i <key> -p 2222 root@localhost "exit"
```

**é©—è­‰é …ï¼š**
- [ ] é€£æ¥æ™‚é–“ < 2 ç§’
- [ ] èªè­‰æ™‚é–“ < 1 ç§’
- [ ] ç„¡æ˜é¡¯å»¶é²

### 10.6 å®¹å™¨æ¸¬è©¦

**å¥åº·æª¢æŸ¥æ¸¬è©¦ï¼š**
```bash
# æª¢æŸ¥å®¹å™¨å¥åº·ç‹€æ…‹
docker ps | grep ansible-bastion

# æŸ¥çœ‹å¥åº·æª¢æŸ¥æ—¥èªŒ
docker inspect ansible-bastion | grep -A 10 "State"
```

**é©—è­‰é …ï¼š**
- [ ] å®¹å™¨æ­£å¸¸é‹è¡Œ
- [ ] å¥åº·æª¢æŸ¥é€šé
- [ ] è‡ªå‹•é‡å•ŸåŠŸèƒ½æ­£å¸¸

---

## æœªä¾†æ“´å±•è¨ˆç•«

### 11.1 çŸ­æœŸè¨ˆç•«ï¼ˆ1-2 å€‹æœˆï¼‰

**éœ€æ±‚ E1ï¼šè‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶**
- [ ] å‰µå»ºå®Œæ•´çš„æ¸¬è©¦å¥—ä»¶
- [ ] é›†æˆ CI/CD ç®¡é“ï¼ˆGitHub Actionsï¼‰
- [ ] å¢åŠ ä»£ç¢¼è¦†è“‹ç‡åˆ° 80%+

**éœ€æ±‚ E2ï¼šæ›´å¤šæ•´åˆç¯„ä¾‹**
- [ ] Terraform éƒ¨ç½²é…ç½®
- [ ] Kubernetes Helm Chart
- [ ] Docker Swarm é…ç½®

**éœ€æ±‚ E3ï¼šå¢å¼·æ–‡æª”**
- [ ] æ•…éšœæ’é™¤è¦–é »æ•™ç¨‹
- [ ] æ¶æ§‹è¨­è¨ˆæŒ‡å—
- [ ] å®‰å…¨åŠ å›ºæ¸…å–®

### 11.2 ä¸­æœŸè¨ˆç•«ï¼ˆ3-6 å€‹æœˆï¼‰

**éœ€æ±‚ E4ï¼šå¤šèªè­‰æ”¯æ´**
- [ ] æ·»åŠ  TOTP æ”¯æ´ï¼ˆæ™‚é–“ä¸€æ¬¡æ€§å¯†ç¢¼ï¼‰
- [ ] æ•´åˆ LDAP/Active Directory
- [ ] æ”¯æ´ OAuth 2.0ï¼ˆç”¨æ–¼æ—¥èªŒç³»çµ±ï¼‰

**éœ€æ±‚ E5ï¼šå¢å¼·çš„è½‰ç™¼è¦å‰‡**
- [ ] æ”¯æ´åŸºæ–¼ç”¨æˆ¶çš„ PermitOpen è¦å‰‡
- [ ] å‹•æ…‹ PermitOpen ç®¡ç†
- [ ] è¦å‰‡çš„ç‰ˆæœ¬æ§åˆ¶å’Œå¯©è¨ˆ

**éœ€æ±‚ E6ï¼šç›£æ§å’Œå‘Šè­¦**
- [ ] Prometheus æŒ‡æ¨™å°å‡º
- [ ] æ—¥èªŒèšåˆé›†æˆ
- [ ] å¯¦æ™‚å‘Šè­¦è¦å‰‡

### 11.3 é•·æœŸè¨ˆç•«ï¼ˆ6-12 å€‹æœˆï¼‰

**éœ€æ±‚ E7ï¼šæœƒè©±ç®¡ç†**
- [ ] SSH æœƒè©±è¨˜éŒ„å’Œå›æ”¾
- [ ] å‘½ä»¤å¯©è¨ˆå’Œæ—¥èªŒ
- [ ] ç•°å¸¸æ´»å‹•æª¢æ¸¬

**éœ€æ±‚ E8ï¼šé«˜å¯ç”¨éƒ¨ç½²**
- [ ] å¤šå¯¦ä¾‹è² è¼‰å‡è¡¡
- [ ] è‡ªå‹•æ•…éšœè½‰ç§»
- [ ] åœ°åŸŸåˆ†å¸ƒå¼éƒ¨ç½²

**éœ€æ±‚ E9ï¼šæ€§èƒ½å„ªåŒ–**
- [ ] é€£æ¥æ± å¯¦ç¾
- [ ] æœƒè©±ç·©å­˜
- [ ] é¡åƒé«”ç©é€²ä¸€æ­¥å„ªåŒ–

### 11.4 å¯é¸åŠŸèƒ½

**éœ€æ±‚ E10ï¼šWeb ç®¡ç†ç•Œé¢**
- [ ] SSH å¯†é‘°ç®¡ç† UI
- [ ] å¯¦æ™‚æ—¥èªŒæŸ¥çœ‹
- [ ] é€£æ¥ç‹€æ…‹ç›£æ§

**éœ€æ±‚ E11ï¼šAPI æ¥å£**
- [ ] REST API ç”¨æ–¼å¯†é‘°ç®¡ç†
- [ ] å‹•æ…‹è¦å‰‡é…ç½® API
- [ ] æ—¥èªŒæŸ¥è©¢ API

**éœ€æ±‚ E12ï¼šé›¢ç·šæ¨¡å¼**
- [ ] æ”¯æ´æœ¬åœ°å¯†é‘°åŒæ­¥
- [ ] é›¢ç·šé©—è­‰å‚™ä»½
- [ ] æ•…éšœæ™‚çš„è‡ªå‹•è½‰ç§»

---

## ç‰ˆæœ¬æ§åˆ¶

| ç‰ˆæœ¬ | æ—¥æœŸ | è®Šæ›´ |
|------|------|------|
| 1.0.0 | 2026-01-09 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«å®Œæ•´çš„è¦æ ¼å®šç¾© |

---

## åƒè€ƒè³‡æº

- [OpenSSH å®˜æ–¹æ–‡æª”](https://man.openbsd.org/sshd_config)
- [Docker å®˜æ–¹æ–‡æª”](https://docs.docker.com/)
- [SSH ProxyCommand æŒ‡å—](https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts)
- [Alpine Linux æ–‡æª”](https://wiki.alpinelinux.org/)

---

**æ–‡æª”æ‰€æœ‰è€…ï¼š** Riven-dev1030
**æœ€å¾Œä¿®æ”¹ï¼š** 2026-01-09
